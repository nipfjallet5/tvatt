/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "../node_modules/uuid/dist/esm-browser/native.js":
/*!*******************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/native.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  randomUUID\n});\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/native.js?");

/***/ }),

/***/ "../node_modules/uuid/dist/esm-browser/regex.js":
/*!******************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/regex.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/regex.js?");

/***/ }),

/***/ "../node_modules/uuid/dist/esm-browser/rng.js":
/*!****************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/rng.js ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ rng)\n/* harmony export */ });\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/rng.js?");

/***/ }),

/***/ "../node_modules/uuid/dist/esm-browser/stringify.js":
/*!**********************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/stringify.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"unsafeStringify\": () => (/* binding */ unsafeStringify),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ \"../node_modules/uuid/dist/esm-browser/validate.js\");\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nfunction unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__.default)(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/stringify.js?");

/***/ }),

/***/ "../node_modules/uuid/dist/esm-browser/v4.js":
/*!***************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/v4.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ \"../node_modules/uuid/dist/esm-browser/native.js\");\n/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ \"../node_modules/uuid/dist/esm-browser/rng.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ \"../node_modules/uuid/dist/esm-browser/stringify.js\");\n\n\n\n\nfunction v4(options, buf, offset) {\n  if (_native_js__WEBPACK_IMPORTED_MODULE_0__.default.randomUUID && !buf && !options) {\n    return _native_js__WEBPACK_IMPORTED_MODULE_0__.default.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || _rng_js__WEBPACK_IMPORTED_MODULE_1__.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/v4.js?");

/***/ }),

/***/ "../node_modules/uuid/dist/esm-browser/validate.js":
/*!*********************************************************!*\
  !*** ../node_modules/uuid/dist/esm-browser/validate.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ \"../node_modules/uuid/dist/esm-browser/regex.js\");\n\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__.default.test(uuid);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);\n\n//# sourceURL=webpack:///../node_modules/uuid/dist/esm-browser/validate.js?");

/***/ }),

/***/ "./app.js":
/*!****************!*\
  !*** ./app.js ***!
  \****************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _buildInfo_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../buildInfo.json */ \"../buildInfo.json\");\n/* harmony import */ var _elements_weekScheduleHTMLElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./elements/weekScheduleHTMLElement */ \"./elements/weekScheduleHTMLElement.js\");\n/* harmony import */ var _elements_weekSelectorHTMLElement__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./elements/weekSelectorHTMLElement */ \"./elements/weekSelectorHTMLElement.js\");\n\r\n\r\n\r\n\r\nwindow.myOldSessions = [];\r\nwindow.myTodaySessions = [];\r\nwindow.haveOldSessions = false;\r\n\r\n// let dropbox;\r\nlet weekSelector;\r\nlet weekSchedule;\r\nlet version = 1;\r\n\r\nDate.prototype.getWeek = function() {\r\n    let date = new Date(this.getTime());\r\n    date.setHours(0, 0, 0, 0);\r\n    // Thursday in current week decides the year.\r\n    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n    // January 4 is always in week 1.\r\n    let week1 = new Date(date.getFullYear(), 0, 4);\r\n    // Adjust to Thursday in week 1 and count number of weeks from date to week1.\r\n    return 1 + Math.round(((date.getTime() - week1.getTime()) / 86400000\r\n        - 3 + (week1.getDay() + 6) % 7) / 7);\r\n};\r\n\r\n// Returns the four-digit year corresponding to the ISO week of the date.\r\nDate.prototype.getWeekYear = function() {\r\n    let date = new Date(this.getTime());\r\n    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);\r\n    return date.getFullYear();\r\n};\r\n\r\nDate.prototype.getPreviousMonday = function() {\r\n    let date = new Date(this.valueOf());\r\n    let day = this.getDay();\r\n    let diff = this.getDate() - day + (day === 0 ? -6:1); // adjust when day is sunday\r\n    return new Date(date.setDate(diff));\r\n};\r\n\r\nDate.prototype.addDays = function(days) {\r\n    this.setDate(this.getDate() + days);\r\n    // let date = new Date(this.valueOf());\r\n    // date.setDate(date.getDate() + days);\r\n    // return date;\r\n};\r\n\r\nDate.prototype.getDayOffset = function(days) {\r\n    let date = new Date(this.valueOf());\r\n    date.setDate(date.getDate() + days);\r\n    return date;\r\n};\r\n\r\nDate.prototype.isSameDay = function(date) {\r\n    return this.getFullYear() === date.getFullYear() &&\r\n        this.getMonth() === date.getMonth() &&\r\n        this.getDate() === date.getDate();\r\n};\r\n\r\nfunction hideKeyboard(element) {\r\n    element.attr('readonly', 'readonly'); // Force keyboard to hide on input field.\r\n    element.attr('disabled', 'true'); // Force keyboard to hide on textarea field.\r\n    setTimeout(function() {\r\n        element.blur();  //actually close the keyboard\r\n        // Remove readonly attribute after keyboard is hidden.\r\n        element.removeAttr('readonly');\r\n        element.removeAttr('disabled');\r\n    }, 100);\r\n}\r\n\r\nfunction manageOldSessions(message, init) {\r\n\r\n    if (init) {\r\n        $('#oldBookingsList').html('');\r\n        if (window.myOldSessions.length > 0) {\r\n            window.haveOldSessions = true;\r\n            window.myOldSessions.forEach(mos => {\r\n                mos.onDelete((deletedSession) => {\r\n                    window.myOldSessions = window.myOldSessions.filter(mosInner => mosInner !== deletedSession);\r\n                    if (window.myOldSessions.length === 0) {\r\n                        window.haveOldSessions = false;\r\n                        $('#oldSessionsPanel').panel('close');\r\n                    }\r\n                })\r\n                $('#oldBookingsList').append(mos);\r\n            })\r\n            $('#oldSessionsPanelMessage').html(message);\r\n            $('#oldSessionsPanel').panel('open');\r\n        }\r\n    }\r\n    else {\r\n        $('#oldSessionsPanelMessage').html(message);\r\n        $('#oldSessionsPanel').panel('open');\r\n    }\r\n}\r\n\r\nfunction manageTodaySessions(message) {\r\n    const tds = window.myTodaySessions[0];\r\n    $('#todaySessionPanelMessage').html(message);\r\n    $('#todayBookingsList').html('');\r\n    $('#todaySessionPanel').panel('open');\r\n    tds.onDelete((deletedSession) => {\r\n        $('#todaySessionPanel').panel('close');\r\n    })\r\n    $('#todayBookingsList').append(tds);\r\n}\r\n\r\nfunction manageActiveSessions(message) {\r\n    const as = window.activeSession;\r\n    $('#todaySessionPanelMessage').html(message);\r\n    $('#todayBookingsList').html('');\r\n    $('#todaySessionPanel').panel('open');\r\n    as.onDelete((deletedSession) => {\r\n        $('#todaySessionPanel').panel('close');\r\n    })\r\n    $('#todayBookingsList').append(as);\r\n}\r\n\r\nlet loadApp = function(){\r\n\r\n    window.dropbox = new Dropbox.Dropbox({\r\n        fetch: fetch,\r\n        accessToken: localStorage.getItem('dbtoken')\r\n    });\r\n\r\n    let content = $('#content');\r\n    content.html('');\r\n\r\n    weekSelector = $(new _elements_weekSelectorHTMLElement__WEBPACK_IMPORTED_MODULE_2__.WeekSelector());\r\n    weekSchedule = $(new _elements_weekScheduleHTMLElement__WEBPACK_IMPORTED_MODULE_1__.WeekSchedule())\r\n        .on('swipeleft', event => {\r\n            weekSelector[0].shiftDays(7);\r\n            weekSchedule[0].slide('right');\r\n        })\r\n        .on('swiperight', event => {\r\n            weekSelector[0].shiftDays(-7);\r\n            weekSchedule[0].slide('left');\r\n        });\r\n\r\n        weekSelector.on('shiftWeekLeft', () => {\r\n            weekSchedule[0].slide('left');\r\n        });\r\n        weekSelector.on('shiftWeekRight', () => {\r\n            weekSchedule[0].slide('right');\r\n        });\r\n\r\n        weekSelector.on('setWeek', (event, weekInfo) => {\r\n            weekSelector[0].enable(false);\r\n            $.when(weekSchedule[0].setWeek(weekInfo)).done(() => {\r\n                weekSelector[0].enable(true);\r\n        });\r\n    });\r\n\r\n    weekSchedule[0].onReady(sessions => {\r\n        manageOldSessions('Checka av gamla pass.', true);\r\n    })\r\n    \r\n    weekSchedule[0].onBookingClick((status, sessions) => {\r\n        if (status === 'haveOldSessions') {\r\n            manageOldSessions('Checka av gamla pass innan du bokar ett nytt.', false);\r\n        }\r\n        if (status === 'haveOldSessionsDelete') {\r\n            manageOldSessions('Checka av gamla pass innan du tar bort dem.', false);\r\n        }\r\n        if (status === 'sessionActive') {\r\n            manageActiveSessions('Checka av pågående pass. Om du inte använde tiden välj \"tvättade aldrig\"', false);\r\n        }\r\n        if (status === 'isTodaySession') {\r\n            manageTodaySessions('Checka av pass');\r\n        }\r\n    })\r\n\r\n    content.append(weekSelector);\r\n    content.append(weekSchedule);\r\n\r\n    weekSelector[0].setDate((new Date()))\r\n\r\n    $('#buildhash').html(`build: ${_buildInfo_json__WEBPACK_IMPORTED_MODULE_0__.buildHash}`)\r\n\r\n};\r\n\r\nlet fetchEnc = function(name, password, key){\r\n    return new Promise(resolve => {\r\n        fetch(`assets/enc/${name}.json.enc`)\r\n        .then(response => response.text())\r\n        .then(encData => {\r\n            resolve(JSON.parse(CryptoJS.AES.decrypt(encData, password).toString(CryptoJS.enc.Utf8)));\r\n        })      \r\n    })\r\n}\r\n\r\nlet loadEnc = async function(password) {\r\n\r\n    const dum = await Promise.all([fetchEnc('dbtoken', password), fetchEnc('data', password)]);\r\n    const dbToken = dum[0].token;\r\n    const apartmentInfo = dum[1];\r\n    \r\n    if (apartmentInfo != null) {\r\n\r\n        $('#apartmentList').html('<p>Välj din lägenhet i listan.</p>');\r\n\r\n        $('#password').addClass('password-valid');\r\n\r\n        hideKeyboard($('#password'));\r\n\r\n        Object.entries(apartmentInfo.apartments).map(([apartmentNumber, name]) => {\r\n            $('<input type=\"button\">')\r\n                .attr('value', apartmentNumber + '. ' + name)\r\n                .appendTo($('#apartmentList'))\r\n                .button({mini: true}).button('refresh')\r\n                .click(event => {\r\n                    console.log('selecting', apartmentNumber + '. ' + name);\r\n\r\n                    console.log('SAVING DATA IN LOCAL STORAGE AND LOADING APP.');\r\n\r\n                    localStorage.setItem('apartment', apartmentNumber);\r\n                    localStorage.setItem('name', name);\r\n                    localStorage.setItem('dbtoken', dbToken);\r\n                    localStorage.setItem('version', version);\r\n\r\n                    loadApp();\r\n                })\r\n                .parent().each((index,item) => {\r\n                    $(item).addClass('apartment-selector');\r\n                });\r\n        });\r\n    }\r\n    else {\r\n        $('#password').addClass('password-invalid');\r\n    }\r\n\r\n}\r\n\r\n$('#password').on('keyup',function(event) {\r\n    $('#password').removeClass('password-valid');\r\n    $('#password').removeClass('password-invalid');\r\n    $('#apartmentList').html('');\r\n    if ($(this).val().length === 4) {\r\n        let password = CryptoJS.SHA256($(this).val()).toString();\r\n        loadEnc(password);\r\n    }\r\n    else if (($(this).val().length > 4)) {\r\n        $('#password').addClass('password-invalid');\r\n    }\r\n});\r\n\r\n$(document).ready(function(){\r\n    if (localStorage.getItem('version') !== null) {\r\n        if (Number.parseInt(localStorage.getItem('version')) >= version) {\r\n            loadApp();\r\n        }\r\n    }\r\n    else {\r\n        console.log('NO DATA IN LOCAL STORAGE. APP NOT LOADED.');\r\n    }\r\n\r\n});\r\n\n\n//# sourceURL=webpack:///./app.js?");

/***/ }),

/***/ "./elements/hourBookingHTMLElement.js":
/*!********************************************!*\
  !*** ./elements/hourBookingHTMLElement.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"HourBooking\": () => (/* binding */ HourBooking)\n/* harmony export */ });\nclass HourBooking extends HTMLElement {\r\n\r\n    constructor(data, doFetch) {\r\n        super();\r\n\r\n        this.data = data;\r\n        this.isMyBooking = false;\r\n        this.isTodayBooking = false;\r\n        this.isOldBooking = false;\r\n        this.doFetch = doFetch;\r\n        this.startTime = new Date(data.year, Number.parseInt(data.month)-1, data.day, data.hour);\r\n        this.endTime = new Date(this.startTime.getTime() + 1000*60*60);\r\n        this.bookingName = \"slot_\" +\r\n            data.apartment + \"_\" +\r\n            data.year + \"_\" +\r\n            data.month + \"_\" +\r\n            data.day + \"_\" +\r\n            data.hour + \"_\" +\r\n            data.identifier + \"_\" +\r\n            'lgh' + data.apartment;\r\n\r\n        this.createHandler = () => {};\r\n        this.deleteHandler = () => {};\r\n\r\n        let template = document.createElement('template');\r\n        template.innerHTML = `\r\n            <style>\r\n                #booking-container {\r\n                    line-height: 22px;\r\n                    font-size: 14px;\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    border-radius: 10px;\r\n                }\r\n                .my-booking {\r\n                    background-color: green;\r\n                    color: white;\r\n                }\r\n                .other-booking {\r\n                    background-color: #ad0000;\r\n                    color: white;\r\n                }\r\n            </style>\r\n            <div id=\"booking-container\">\r\n        `;\r\n        // this.attachShadow({mode: 'open'}).appendChild(template.content.cloneNode(true));\r\n        this.appendChild(template.content.cloneNode(true));\r\n    }\r\n\r\n    connectedCallback() {\r\n\r\n        let bookingText = this.doFetch ? '...' : this.data.apartment;\r\n        let bookingClass = this.data.apartment === localStorage.getItem('apartment') ? 'my-booking' : 'other-booking';\r\n\r\n        this.container = $(this).children('#booking-container')\r\n            .html(bookingText)\r\n            .addClass(bookingClass);\r\n\r\n        this.container[0].addEventListener('click', event => {\r\n            console.log('BOOKING CLICKED', this.data.apartment, localStorage.getItem('apartment'));\r\n\r\n            if (window.haveOldSessions) {\r\n                console.log('HAVE OLD SESSIONS. NOT DELETING!');\r\n                this.deleteHandler('haveOldSessionsDelete');\r\n                return false;\r\n            }\r\n\r\n            if (window.activeSession) {\r\n                console.log(window.activeSession.bookings.indexOf(this));\r\n                if (window.activeSession.getApartment() === localStorage.getItem('apartment') && window.activeSession.bookings.indexOf(this) >= 0) {\r\n                    \r\n                    console.log('SESSION ACTIVE. NOT DELETING!', window.activeSession.getApartment(), localStorage.getItem('apartment'));\r\n                    this.deleteHandler('sessionActive');\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            if (this.data.apartment === localStorage.getItem('apartment') || localStorage.getItem('apartment') == 122) {\r\n                this.delete();\r\n            }\r\n        });\r\n\r\n        if (!this.doFetch) return;\r\n\r\n        let searchPromises = [\r\n            window.dropbox.filesSearch({path: '', query: this.data.identifier}),\r\n            // dropbox.filesSearch({path: '', query: 'lgh' + this.data.apartment})\r\n        ];\r\n\r\n        Promise.all(searchPromises).then(data => {\r\n            if (data[0].matches.length === 0) {\r\n                const currentTime = new Date();\r\n\r\n                if (currentTime > this.startTime) {\r\n                    console.log('TOO EARLY. NOT ADDING!');\r\n                    this.createHandler('tooEarlyBooking');\r\n                    this.remove();\r\n                    return;\r\n                }\r\n\r\n                if (window.haveOldSessions) {\r\n                    console.log('HAVE OLD SESSIONS. NOT ADDING!');\r\n                    this.createHandler('haveOldSessions');\r\n                    this.remove();\r\n                    return;\r\n                }\r\n\r\n                window.dropbox.filesUpload({path: \"/\" + this.bookingName, contents: \"content\"}).then(() => {\r\n                    this.container\r\n                        .html(this.data.apartment);\r\n                        this.createHandler('success');\r\n                    }, () => {console.log('an error occured');})\r\n            }\r\n            else {\r\n                console.log(\"slot is taken\");\r\n                $(this).remove();\r\n                weekSchedule[0].reload();\r\n                alert('tiden har bokats av någon annan efter att du gick in på sidan');\r\n            }\r\n        });\r\n    }\r\n\r\n    delete() {\r\n        // const todaysDate = new Date();\r\n        // if (Number.parseInt(this.data.year) === todaysDate.getFullYear() && Number.parseInt(this.data.month)-1 === todaysDate.getMonth() && Number.parseInt(this.data.day) === todaysDate.getDate()) {\r\n        //     if (!manageOldBookings(localStorage.getItem('apartment'), new Date(todaysDate.getTime() + 2*1000*60*60*24), \"Checka av dagens pass\")) return;\r\n        // }\r\n        // if (!manageOldBookings(localStorage.getItem('apartment'), todaysDate)) {\r\n        // }\r\n        // else {\r\n        return new Promise(resolve => {\r\n            if (this.container) this.container.html('...');\r\n            console.log('DELETING', this.bookingName);\r\n            window.dropbox.filesDelete({path: \"/\" + this.bookingName}) //delete when canceling\r\n                .then((status) =>  {\r\n                    $(this).remove();\r\n                    resolve(status);\r\n                    this.deleteHandler('success');\r\n                }, () => {console.log('an error occured');})\r\n        })\r\n\r\n                // }\r\n    }\r\n\r\n    onCreate(handler) {\r\n        this.createHandler = handler;\r\n    }\r\n\r\n    onDelete(handler) {\r\n        this.deleteHandler = handler;\r\n    }\r\n}\r\nwindow.customElements.define('hour-booking', HourBooking);\r\n\n\n//# sourceURL=webpack:///./elements/hourBookingHTMLElement.js?");

/***/ }),

/***/ "./elements/laundrySessionHTMLElement.js":
/*!***********************************************!*\
  !*** ./elements/laundrySessionHTMLElement.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"LaundrySession\": () => (/* binding */ LaundrySession)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uuid */ \"../node_modules/uuid/dist/esm-browser/v4.js\");\n\r\n\r\nclass LaundrySession extends HTMLElement {\r\n    constructor(date) {\r\n        super();\r\n\r\n        this.bookings = [];\r\n        this.isMySession = false;\r\n        this.isTodaySession = false;\r\n        this.isOldSession = false;\r\n        this.followingSession = undefined;\r\n        this.date = date;\r\n        this.uuid = (0,uuid__WEBPACK_IMPORTED_MODULE_0__.default)(); \r\n        this.dateString = `${this.date.getDate()}/${this.date.getMonth()+1}`;\r\n        this.daysAgo = Math.floor(((new Date()) - this.date)/1000/60/60/24);\r\n        this.cleanCode = 0;\r\n        this.onDeleteHandler = () => {};\r\n\r\n        let template = document.createElement('template');\r\n        template.innerHTML = /*html*/`\r\n            <style>\r\n                #older-booking-container {\r\n                    background-color: lightgray;\r\n                    margin: 10px 0 0 0;\r\n                    padding: 5px;\r\n                    position: relative;\r\n                }\r\n                #older-booking-container-overlay {\r\n                    background-color: #55555599;\r\n                    color: white;\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    position: absolute;\r\n                    top: 0;\r\n                    left: 0;\r\n                    text-align: center;\r\n                    line-height: 100px;\r\n                    visibility: hidden;\r\n                }\r\n                .bookingname {\r\n                    /* font-family: monospace; */\r\n                    font-weight: bold;\r\n                }\r\n                .cleantask {\r\n                    display: grid;\r\n                    grid-template-columns: auto 40px;\r\n                    height: 20px;\r\n                    margin: 5px 0 0 0;\r\n                }\r\n                .raderapass {\r\n                    width: 50%;\r\n                    height: 25px;\r\n                    line-height: 25px;\r\n                    text-align: center;\r\n                    margin: 10px 0 0 0;\r\n                    background-color: darkred;\r\n                    color: white;\r\n                    border-radius: 5px;\r\n                    /* pointer-events: none; */\r\n                }\r\n\r\n                input[type=checkbox]{\r\n                    height: 0;\r\n                    width: 0;\r\n                    visibility: hidden;\r\n                  }\r\n                  \r\n                label {\r\n                    cursor: pointer;\r\n                    top: -20px;\r\n                    width: 40px;\r\n                    height: 20px;\r\n                    background: darkred;\r\n                    /* display: block; */\r\n                    border-radius: 20px;\r\n                    position: relative;\r\n                }\r\n                \r\n                label:after {\r\n                    content: '';\r\n                    position: absolute;\r\n                    top: 2px;\r\n                    left: 2px;\r\n                    width: 16px;\r\n                    height: 16px;\r\n                    background: #fff;\r\n                    border-radius: 16px;\r\n                    transition: 0.3s;\r\n                }\r\n                \r\n                input:checked + label {\r\n                    background: darkgreen;\r\n                }\r\n                \r\n                input:checked + label:after {\r\n                    left: calc(100% - 2px);\r\n                    transform: translateX(-100%);\r\n                    }\r\n                \r\n                label:active:after {\r\n                    width: 15px;\r\n                }\r\n\r\n            </style>\r\n            <div id=\"older-booking-container\">\r\n            <div class=bookingname>pass: ${this.dateString} (${this.daysAgo === 0 ? 'idag' : this.daysAgo + ' dagar sedan'})</div>\r\n            <div class=\"cleantasks\">\r\n                    <div class=cleantask><div style=\"height: 20px\">sopat golvet</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch1_${this.uuid}\" /><label for=\"switch1_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">våttorkat golvet</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch2_${this.uuid}\" /><label for=\"switch2_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">våttorkat ytor</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch3_${this.uuid}\" /><label for=\"switch3_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">ludd torktumlare</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch4_${this.uuid}\" /><label for=\"switch4_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">filter torkskåp</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch5_${this.uuid}\" /><label for=\"switch5_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">rengjort fack</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch6_${this.uuid}\" /><label for=\"switch6_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">städade inte</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch7_${this.uuid}\" /><label for=\"switch7_${this.uuid}\"></label></div></div>\r\n                    <div class=cleantask><div style=\"height: 20px\">tvättade aldrig</div><div style=\"height: 20px\"><input type=\"checkbox\" id=\"switch8_${this.uuid}\" /><label for=\"switch8_${this.uuid}\"></label></div></div>\r\n                </div>\r\n                <div class=\"raderapass\">skicka</div>\r\n                <div id=\"older-booking-container-overlay\">skickar ...<div>\r\n            </div>\r\n        `;\r\n        this.appendChild(template.content.cloneNode(true));\r\n    }\r\n\r\n    connectedCallback() {\r\n\r\n        // const cleantasks = $(this).children('.cleanAnswer');\r\n        // const sendbuttons = $(this).children('.raderapass');\r\n        const cleantasks = this.querySelectorAll('input[type=checkbox]');\r\n        const sendbutton = this.querySelector('.raderapass');\r\n        const overlay = this.querySelector('#older-booking-container-overlay');\r\n        // .html(bookingText)\r\n        // .addClass(bookingClass);\r\n\r\n        cleantasks.forEach((element) => {\r\n            $(element).on('change', event => {\r\n                this.nChecked = [...cleantasks].filter(e => e.checked).length;\r\n                console.log('TOGGELING', this.nChecked);\r\n                sendbutton.style['background-color'] = this.nChecked > 0 ? 'darkgreen' : 'darkred';\r\n                // sendbutton.style['pointer-events'] = nChecked > 0 ? 'auto' : 'none';\r\n                this.cleanCode = [...cleantasks].map(element => element.checked).reduce((res, x) => res << 1 | x)\r\n                console.log(this.cleanCode);\r\n            });\r\n        })\r\n\r\n        $(sendbutton).on('click', event => {\r\n\r\n            if (this.cleanCode === 0) {\r\n                $('#popupMessageContent').html('Välj minst en städåtgärd. Eller \"tvättade aldrig\" om du inte använde passet.');\r\n                $('#popupMessage').popup('open');\r\n                return;\r\n            }\r\n\r\n            overlay.style.visibility = \"visible\";\r\n\r\n            const checkName = \"check_\" +\r\n            this.getApartment() + \"_\" +\r\n            this.followingSession.getApartment() + \"_\" +\r\n            this.bookings[0].data.year + \"_\" +\r\n            this.bookings[0].data.month + \"_\" +\r\n            this.bookings[0].data.day + \"_\" +\r\n            this.cleanCode + \"_\" +\r\n            this.bookings[0].data.hour\r\n\r\n            Promise.all(this.bookings.map(b => b.delete())).then(statuses => {\r\n                console.log(statuses);\r\n                this.remove();\r\n                this.onDeleteHandler(this);\r\n                window.dropbox.filesUpload({path: \"/checks/\" + checkName, contents: \"content\"})\r\n                    .then(() => {\r\n                    }, () => {console.log('an error occured');})\r\n                overlay.style.visibility = \"hidden\";\r\n            })\r\n\r\n            // this.bookings.forEach(b => {\r\n            //     // b.delete();\r\n\r\n            //     const checkName = \"check_\" +\r\n            //     b.data.apartment + \"_\" +\r\n            //     b.data.year + \"_\" +\r\n            //     b.data.month + \"_\" +\r\n            //     b.data.day + \"_\" +\r\n            //     this.cleanCode;\r\n\r\n            //     console.log('DELETING', checkName);\r\n                \r\n\r\n            //     // window.dropbox.filesDelete({path: \"/\" + bookingName}) //delete when checking off\r\n            //     // .then(() =>  {\r\n            //     //     console.log('booking deleted');\r\n            //     //     this.remove();\r\n            //     //     this.onDeleteHandler(this.key);\r\n            //     //     weekSchedule[0].reload();\r\n            //     //     overlay.style.visibility = \"hidden\";\r\n            //     //     window.dropbox.filesUpload({path: \"/\" + checkName, contents: \"content\"})\r\n            //     //         .then(() => {\r\n            //     //         }, () => {console.log('an error occured');})\r\n\r\n            //     // }, () => {console.log('an error occured');})\r\n            // })\r\n        });\r\n    }\r\n\r\n    addBookingHour(bookingHour) {\r\n        this.bookings.push(bookingHour);\r\n        this.bookings.sort((a,b) => a.startTime - b.startTime)\r\n    }\r\n\r\n    getStartTime() {\r\n        return this.bookings[0].startTime;\r\n    }\r\n\r\n    getEndTime() {\r\n        return this.bookings[this.bookings.length - 1].endTime;\r\n    }\r\n\r\n    getApartment() {\r\n        return this.bookings[0].data.apartment;\r\n    }\r\n\r\n    onDelete(handler) {\r\n        this.onDeleteHandler = handler;\r\n    }\r\n\r\n}\r\n\r\nwindow.customElements.define('laundry-session', LaundrySession);\r\n\n\n//# sourceURL=webpack:///./elements/laundrySessionHTMLElement.js?");

/***/ }),

/***/ "./elements/weekScheduleHTMLElement.js":
/*!*********************************************!*\
  !*** ./elements/weekScheduleHTMLElement.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"WeekSchedule\": () => (/* binding */ WeekSchedule)\n/* harmony export */ });\n/* harmony import */ var _hourBookingHTMLElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hourBookingHTMLElement */ \"./elements/hourBookingHTMLElement.js\");\n/* harmony import */ var _laundrySessionHTMLElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./laundrySessionHTMLElement */ \"./elements/laundrySessionHTMLElement.js\");\n\r\n\r\n\r\nclass WeekSchedule extends HTMLElement {\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.sessions = {}\r\n        this.readyHandler = () => {};\r\n        this.bookingClickHandler = () => {};\r\n\r\n        let template = document.createElement('template');\r\n        template.innerHTML = /*html*/`\r\n            <style>\r\n                #grid-container {\r\n                    position: relative;\r\n                    display: grid;\r\n                    grid-template-columns: repeat(8, 1fr);\r\n                    cursor: pointer;\r\n                }\r\n                .date-header-element {\r\n                    font-weight: bold;\r\n                    text-align: center;\r\n                    text-shadow: none;\r\n                    height: 40px;\r\n                }\r\n                .date-today {\r\n                    background-color: #d1d1dc !important;\r\n                }\r\n                .date-today-day-element {\r\n                    color: blue;\r\n                    text-decoration: underline;\r\n                }\r\n                .hour-item {\r\n                    font-weight: bold;\r\n                    text-align: center;\r\n                    height: 22px;\r\n                    border: 1px solid rgba(0, 0, 0, 0.3);\r\n                }\r\n                .date-element {\r\n                    color: black;\r\n                    font-size: 12px;\r\n                    word-spacing: -2px;\r\n                }\r\n                .slot-item {\r\n                    /*padding: 1px;*/\r\n                    background-color: #e9e9e9;\r\n                    border: 1px solid rgba(0, 0, 0, 0.3);\r\n                    border-radius: 3px;\r\n                    height: 22px;\r\n                    text-align: center;\r\n                    font-weight: bold;\r\n                    text-shadow: none;\r\n                }\r\n                .check-item {\r\n                    background-color: #e9e9e9;\r\n                    border: 1px solid rgba(0, 0, 0, 0.3);\r\n                    border-radius: 3px;\r\n                    text-align: center;\r\n                    font-weight: bold;\r\n                    text-shadow: none;\r\n                }\r\n                #weekNumberElement {\r\n                    background-color: black;\r\n                    color: white;\r\n                    font-size: 16px;\r\n                    text-align: center;\r\n                    line-height: 40px;\r\n                    text-shadow: none;\r\n                }\r\n            </style>\r\n            <div id=\"grid-container\">\r\n        `;\r\n        // this.attachShadow({mode: 'open'}).appendChild(template.content.cloneNode(true));\r\n        this.appendChild(template.content.cloneNode(true));\r\n\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.weekGrid = $('#grid-container')\r\n    }\r\n\r\n    slide(direction) {\r\n        let elementWidth = this.weekGrid.width();\r\n        let offsets = direction === 'right' ? [-elementWidth, elementWidth] : [elementWidth, -elementWidth];\r\n        $('#weekNumberElement').css({color: 'black'});\r\n        $('.date-element').css({color: 'white'});\r\n\r\n        this.weekGrid.animate({\r\n            left: offsets[0] + 'px'\r\n        },200, () => {\r\n            this.weekGrid.css({left: offsets[1] + 'px'});\r\n            this.weekGrid.animate({\r\n                left: \"0px\"\r\n            },200, () => {\r\n                $('#weekNumberElement').css({color: 'white'});\r\n                $('.date-element').css({color: 'black'});\r\n            })\r\n        });\r\n    }\r\n\r\n    setWeek(weekInfo) {\r\n\r\n        const self = this;\r\n\r\n        let setWeekTask = new $.Deferred();\r\n\r\n        let currentDate = new Date();\r\n\r\n        this.weekInfo = weekInfo;\r\n\r\n        let days = ['M', 'T', 'O', 'T', 'F', 'L', 'S'];\r\n        let months = ['jan', 'feb', 'mar', 'apr', 'maj', 'jun', 'jul', 'aug', 'sep', 'okt', 'nov', 'dec'];\r\n\r\n        this.weekGrid.html(\"\");\r\n        this.weekGrid\r\n            .append($(\"<div>\")\r\n            .attr('id', 'weekNumberElement')\r\n            .addClass('date-header-element')\r\n            .html('v' + weekInfo.weekNo));\r\n\r\n        for (let day = 0; day <= 6; day++) {\r\n\r\n            let dayElement = $('<div>')\r\n                .addClass('day-element')\r\n                // .addClass(weekInfo.mondayDate.getDayOffset(day).isSameDay(currentDate) ? 'date-today-day-element' : '')\r\n                .html(days[day]);\r\n\r\n            let dateElement = $('<div>')\r\n                .addClass('date-element')\r\n                // .html(weekInfo.mondayDate.getDayOffset(day).getDate() + \"/\"+ (weekInfo.mondayDate.getDayOffset(day).getMonth() + 1));\r\n                .html(weekInfo.mondayDate.getDayOffset(day).getDate() + \" \"+ months[(weekInfo.mondayDate.getDayOffset(day).getMonth())]);\r\n\r\n            let dateHeaderElement = $('<div>').addClass('date-header-element').append(dayElement).append(dateElement);\r\n            // if (weekInfo.mondayDate.getDayOffset(day).isSameDay(currentDate)) dateHeaderElement.addClass('date-today');\r\n\r\n            this.weekGrid.append(dateHeaderElement);\r\n        }\r\n\r\n        for (let hour = 7; hour<=22; hour++) {\r\n            this.weekGrid.append($('<div>').addClass('hour-item').html(hour));\r\n\r\n            for (let day = 0; day <= 6; day++) {\r\n\r\n                let year = weekInfo.mondayDate.getDayOffset(day).getFullYear();\r\n                let month = weekInfo.mondayDate.getDayOffset(day).getMonth() + 1;\r\n                let date = weekInfo.mondayDate.getDayOffset(day).getDate();\r\n\r\n                let slotContainer = $('<div>')\r\n                    .addClass('slot-item')\r\n                    .attr('id', year + '_' + month + '_' + date + '_' + hour)\r\n                    .data({\r\n                        apartment: localStorage.getItem('apartment'),\r\n                        year: year,\r\n                        month: month,\r\n                        day: date,\r\n                        hour: hour,\r\n                        identifier: year + '' + month + '' + date + '' + hour\r\n                    })\r\n                    .click(function() {\r\n                        if ($(this).children().length === 0) {\r\n\r\n                            const bookingElement = new _hourBookingHTMLElement__WEBPACK_IMPORTED_MODULE_0__.HourBooking($(this).data(), true);\r\n\r\n                            bookingElement.onCreate(status => {\r\n                                self.bookingClickHandler(status, this.sessions);\r\n                            });\r\n\r\n                            bookingElement.onDelete(status => {\r\n                                self.bookingClickHandler(status, this.sessions);\r\n                            });\r\n\r\n                            $(this).append(bookingElement);\r\n                        }\r\n                        // else {\r\n                        //     let booking = $(this).children('hour-booking');\r\n                        //     if (booking[0].data.apartment === localStorage.getItem('apartment')) {\r\n                        //         booking[0].delete();\r\n                        //     }\r\n                        //     else {\r\n                        //         //TODO ...\r\n                        //         // alert(booking[0].data.apartment)\r\n                        //     }\r\n                        // }\r\n                    })\r\n                    .appendTo(this.weekGrid);\r\n\r\n                if (weekInfo.mondayDate.getDayOffset(day).isSameDay(currentDate)) slotContainer.addClass('date-today');\r\n\r\n            }\r\n        }\r\n\r\n        // this.weekGrid.append($('<div>').addClass('hour-item'));\r\n        // for (let day = 0; day <= 6; day++) {\r\n        //     let checkContainer = $('<div>').addClass('check-item').html('✔').appendTo(this.weekGrid)\r\n\r\n        // }\r\n\r\n        $.when(this.getBookings()).done(data => {\r\n\r\n            this.sessions = {}\r\n\r\n            const currentTime = new Date();\r\n            const todayDate = new Date(currentTime.getFullYear(),0,0,0,0);\r\n            // ; todayDate.setHours(0); todayDate.setMinutes(0); todayDate.setSeconds(0); todayDate.setMilliseconds(0);\r\n\r\n            data.forEach(b => {\r\n\r\n                const bookingDate = new Date(b.year, b.month-1, b.day);\r\n                const sessionKey = b.apartment + '_' + b.year + '_' + b.month + '_' + b.day;\r\n\r\n                const bookingElement = new _hourBookingHTMLElement__WEBPACK_IMPORTED_MODULE_0__.HourBooking(b, false);\r\n\r\n                bookingElement.onCreate(status => {\r\n                    this.bookingClickHandler(status, this.sessions);\r\n                });\r\n\r\n                bookingElement.onDelete(status => {\r\n                    this.bookingClickHandler(status, this.sessions);\r\n                });\r\n\r\n                bookingElement.isMyBooking = b.apartment === localStorage.getItem('apartment');               \r\n                // bookingElement.isOldBooking = bookingDate < todayDate;\r\n                bookingElement.isOldBooking = bookingElement.endTime < currentTime;\r\n                bookingElement.isTodayBooking = bookingDate.getTime() === todayDate.getTime();\r\n\r\n                if (!this.sessions.hasOwnProperty(sessionKey)) this.sessions[sessionKey] = new _laundrySessionHTMLElement__WEBPACK_IMPORTED_MODULE_1__.LaundrySession(bookingDate);\r\n                this.sessions[sessionKey].addBookingHour(bookingElement);\r\n                this.sessions[sessionKey].isMySession = bookingElement.isMyBooking;\r\n                this.sessions[sessionKey].isOldSession = bookingElement.isOldBooking;\r\n                this.sessions[sessionKey].isTodaySession = bookingElement.isTodayBooking;\r\n \r\n                let slotElement = this.weekGrid.children('#' + b.year + '_' + b.month + '_' + b.day + '_' + b.hour);\r\n\r\n                if (slotElement.length > 0) {\r\n                    slotElement.html('');\r\n                    slotElement.append(bookingElement);\r\n                }\r\n            });\r\n\r\n            const sortedSessions = Object.values(this.sessions).sort((a,b) => a.getStartTime() - b.getStartTime());\r\n            const allSessions = Object.values(this.sessions);\r\n            allSessions.forEach(s => {\r\n                const sessionIndex = sortedSessions.findIndex(ss => ss.getStartTime().getTime() === s.getStartTime().getTime());\r\n                if (sessionIndex < allSessions.length - 1) s.followingSession = sortedSessions[sessionIndex + 1];\r\n                if (s.getStartTime() < currentTime && s.getEndTime() > currentTime) window.activeSession = s;\r\n                // console.log(sessionIndex, s.getApartment());\r\n            })\r\n            window.myOldSessions = Object.values(this.sessions).filter(s => s.isMySession && s.isOldSession);\r\n            window.myTodaySessions = Object.values(this.sessions).filter(s => s.isMySession && s.isTodaySession);\r\n\r\n            console.log('ALL SESSIONS', this.sessions);\r\n            console.log('MY OLD SESSIONS', window.myOldSessions);\r\n            console.log('MY TODAY SESSIONS', window.myTodaySessions);\r\n            console.log('ACTIVE SESSION', window.activeSession);\r\n\r\n            this.readyHandler(this.sessions);\r\n            setWeekTask.resolve();\r\n        });\r\n\r\n        return setWeekTask;\r\n    }\r\n\r\n\r\n    getBookings() {\r\n\r\n        let fetchTask = new $.Deferred();\r\n    \r\n        window.dropbox.filesListFolder({path: ''})\r\n            .then(data => {\r\n    \r\n                let bookings = data.entries\r\n                    .filter(booking => booking.name.startsWith(\"slot_\"))\r\n                    .map(booking => {\r\n                        let bookingData = {\r\n                            apartment: booking.name.split('_')[1],\r\n                            year: booking.name.split('_')[2],\r\n                            month: booking.name.split('_')[3],\r\n                            day: booking.name.split('_')[4],\r\n                            hour: booking.name.split('_')[5],\r\n                            identifier: booking.name.split('_')[6]\r\n                        };\r\n    \r\n                        return bookingData;\r\n                    });\r\n    \r\n                let duplicateBookings = data.entries\r\n                    .filter(booking => booking.name.startsWith(\"slot_\"))\r\n                    .map(booking => {\r\n                        // console.log(booking.name, booking.server_modified);\r\n                        return booking.name.split('_').slice(2,6).join('_')\r\n                    })\r\n                    .reduce((acc, el, i, arr) => {\r\n                        if (arr.indexOf(el) !== arr.lastIndexOf(el)) {\r\n                            if (!acc.hasOwnProperty(el)) acc[el] = [];\r\n                            acc[el].push(data.entries[i]);\r\n                        }\r\n                        return acc;\r\n                    }, {});\r\n    \r\n                Object.values(duplicateBookings).forEach(dbs => {\r\n                    return dbs\r\n                        .sort((a, b) => (new Date(a.server_modified) - new Date(b.server_modified)))\r\n                        .reduce((res, db, i, array) => array.slice(1), [])\r\n                        .forEach(db => {\r\n                            console.log('deleting', db.path_lower);\r\n                            window.dropbox.filesDelete({path: db.path_lower}).then(() => { //delete when duplicates\r\n                                console.log('duplicates deleted');\r\n                                weekSchedule[0].reload();\r\n                            });\r\n                        })\r\n                });\r\n    \r\n                fetchTask.resolve(bookings);\r\n    \r\n            }, console.error);\r\n    \r\n        return fetchTask;\r\n    };\r\n\r\n    reload() {\r\n        this.setWeek(this.weekInfo);\r\n    }\r\n\r\n    onBookingClick(handler) {\r\n        this.bookingClickHandler = handler;\r\n    }\r\n\r\n    onReady(handler) {\r\n        this.readyHandler = handler;\r\n    }\r\n\r\n}\r\nwindow.customElements.define('week-schedule', WeekSchedule);\r\n\n\n//# sourceURL=webpack:///./elements/weekScheduleHTMLElement.js?");

/***/ }),

/***/ "./elements/weekSelectorHTMLElement.js":
/*!*********************************************!*\
  !*** ./elements/weekSelectorHTMLElement.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"WeekSelector\": () => (/* binding */ WeekSelector)\n/* harmony export */ });\nclass WeekSelector extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        let template = document.createElement('template');\r\n        template.innerHTML = `\r\n            <style>\r\n                .info-grid {\r\n                  display: grid;\r\n                  grid-template-columns: 45px auto;\r\n                }\r\n            </style>\r\n            \r\n            <div class=\"info-grid\">\r\n                <div id=\"infoWrapper\"><input data-wrapper-class=\"infoButton\" id=\"info\" type=\"button\"></div>\r\n                <div id=\"headerWrapper\"><input data-wrapper-class=\"headerButton\" id=\"header\" type=\"button\"></div>\r\n            </div>\r\n            <div class=\"ui-grid-b\">\r\n                <div class=\"ui-block-a\"><input class=\"weekSelectButton\" id=\"previous\" type=\"button\" value=\"förra\"></div>\r\n                <div class=\"ui-block-b\"><input class=\"weekSelectButton\" id=\"current\" type=\"button\" value=\"denna vecka\"></div>\r\n                <div class=\"ui-block-c\"><input class=\"weekSelectButton\" id=\"next\" type=\"button\" value=\"nästa\"></div>\r\n            </div>\r\n        `;\r\n        // this.attachShadow({mode: 'open'}).appendChild(template.content.cloneNode(true));\r\n        this.appendChild(template.content.cloneNode(true));\r\n\r\n        this.currentDate = new Date();\r\n        this.currentWeek = this.currentDate.getWeek();\r\n    }\r\n\r\n    connectedCallback() {\r\n\r\n        $('week-selector #info')\r\n            .button({\r\n                mini: true,\r\n                icon: 'bars',\r\n                iconpos: 'notext'\r\n            })\r\n            .click(event => {\r\n                $('#infoPanel').panel('open');\r\n                // $('#infoPanel').panel({\r\n                //     // display: 'overlay',\r\n                //     animate: true,\r\n                // }).panel('open');\r\n            });\r\n\r\n\r\n        let apartmentHeader = $('week-selector #header')\r\n            .attr('value', localStorage.getItem('apartment') + ' ' + localStorage.getItem('name'))\r\n            .button({mini: true})\r\n            .click(event => {\r\n                localStorage.clear();\r\n                location.reload();\r\n            });\r\n\r\n        // let delay;\r\n        // apartmentHeader[0].addEventListener('mousedown', function (e) {\r\n        //     delay = setTimeout(() => {\r\n        //         console.log('press detected');\r\n        //         localStorage.clear();\r\n        //         location.reload();\r\n        //         }, 100);\r\n        // }, true);\r\n        // apartmentHeader[0].addEventListener('mouseup', function (e) {\r\n        //     clearTimeout(delay);\r\n        // });\r\n        // apartmentHeader[0].addEventListener('mouseout', function (e) {\r\n        //     clearTimeout(delay);\r\n        // });\r\n\r\n        $('.weekSelectButton').button({mini: true});\r\n\r\n        $('.weekSelectButton#previous').click(event => {\r\n            this.shiftDays(-7);\r\n            // $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n            $(this).trigger('shiftWeekLeft');\r\n        });\r\n\r\n        $('.weekSelectButton#current')\r\n            .click(event => {\r\n                this.shiftDays(0);\r\n                // $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n            })\r\n            .on('taphold', event => {\r\n                // $('#popupDatePicker').popup('open');\r\n                $('<div>')\r\n                    .datebox({mode:'calbox'})\r\n                    .bind('datebox', (event, passed) => {\r\n                        if ( passed.method === 'set' ) {\r\n                            console.log(passed);\r\n                        }\r\n                    })\r\n                    .datebox('open');\r\n                $('.ui-title').html('Datum');\r\n            });\r\n\r\n        $('.weekSelectButton#next').click(event => {\r\n            this.shiftDays(7);\r\n            $(this).trigger('shiftWeekRight');\r\n            // $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n        });\r\n    }\r\n\r\n    setDate(date) {\r\n        this.currentDate = date;\r\n        this.currentWeek = this.currentDate.getWeek();\r\n        $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n    }\r\n\r\n    shiftDays(nDays) {\r\n        if (nDays !== 0) this.currentDate.addDays(nDays);\r\n        else this.currentDate = new Date();\r\n        this.currentWeek = this.currentDate.getWeek();\r\n        $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n    }\r\n\r\n    // reload() {\r\n    //     this.currentDate = new Date();\r\n    //     $(this).trigger('setWeek', {weekNo: this.currentWeek, mondayDate: this.currentDate.getPreviousMonday()});\r\n    // }\r\n\r\n    enable(value) {\r\n        $('.weekSelectButton').prop(\"disabled\", !value);\r\n    }\r\n}\r\nwindow.customElements.define('week-selector', WeekSelector);\r\n\n\n//# sourceURL=webpack:///./elements/weekSelectorHTMLElement.js?");

/***/ }),

/***/ "../buildInfo.json":
/*!*************************!*\
  !*** ../buildInfo.json ***!
  \*************************/
/***/ ((module) => {

eval("module.exports = JSON.parse('{\"buildHash\":\"89068a65\"}');\n\n//# sourceURL=webpack:///../buildInfo.json?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./app.js");
/******/ 	
/******/ })()
;